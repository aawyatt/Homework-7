---
title: "HW7"
author: "Alison Wyatt"
date: "`r Sys.Date()`"
output: html_document
---
```{r, warning = FALSE}
library(tidyverse)
library(dplyr)
```


The General Social Survey (GSS) has been run by NORC every other year since 1972 to keep track of current opinions across the United States.

The package productplots contains a subset of this data, called happy. You can access the data using the command
```{r}
data(happy, package="productplots")
head(happy)
```

```{r}
HAPPY <- readRDS("data/HAPPY.rds")
head(HAPPY)
```

1. Data cleaning: the values “IAP”, “DK” and “NA” all encode missing values. Replace all of these instances by the value NA.
```{r}
HAPPY = HAPPY %>% mutate(POLVIEWS = replace(POLVIEWS, POLVIEWS == "IAP", "NA"))
HAPPY = HAPPY %>% mutate(POLVIEWS = replace(POLVIEWS, POLVIEWS == "DK", "NA"))
HAPPY = HAPPY %>% mutate(POLVIEWS = replace(POLVIEWS, POLVIEWS == "NA", "NA"))
HAPPY$POLVIEWS = factor(HAPPY$POLVIEWS, levels = c("SLGHTLY CONSERVATIVE", "CONSERVATIVE", "EXTRMLY CONSERVATIVE", "MODERATE", "SLIGHTLY LIBERAL", "LIBERAL", "EXTREMELY LIBERAL", "NA"))
ggplot(data = HAPPY, aes(x= POLVIEWS)) + geom_bar()
```
The largest group in POLVIEWS is the Moderate group. 

2. Check the type of the variable and cast into the right type (factor variable for categorical variables). For age, change “89 OR OLDER” to 89 and assume the variable should be numeric.
```{r}
str(HAPPY)
table(HAPPY$POLVIEWS)
```
```{r}
HAPPY$SEX = factor(HAPPY$SEX, levels = c("MALE", "FEMALE"))
ggplot(data = HAPPY, aes(x= SEX)) + geom_bar()

```
There are more females than males in this group. 

```{r}
HAPPY$MARITAL = factor(HAPPY$MARITAL, levels = c("NEVER MARRIED", "MARRIED", "SEPERATED", "DIVORCED", "WIDOWED"))
ggplot(data = HAPPY, aes(x= MARITAL)) + geom_bar()
```
The largest classification in the marital group is married, then married, then divorced, then widowed. The least amount of people had no response. 

```{r}
HAPPY$HAPPY = factor(HAPPY$HAPPY, levels = c("NOT TOO HAPPY", "PRETTY HAPPY", "VERY HAPPY"))
ggplot(data = HAPPY, aes(x= HAPPY)) + geom_bar()
```
The largest group is pretty happy and the smallest group is not too happy. The fewest people did not have a response. 

```{r}
HAPPY$HEALTH= factor(HAPPY$HEALTH,levels= c("IAP", "POOR", "FAIR", "GOOD", "EXCELLENT", "DK"))
ggplot(data = HAPPY, aes(x= HEALTH)) + geom_bar()
```
The most people in the group are in good health. 

```{r}
HAPPY$DEGREE= factor(HAPPY$DEGREE,levels= c("LT HIGH SCHOOL", "HIGH SCHOOL", "BACHELOR", "GRADUATE"))
ggplot(data = HAPPY, aes(x= DEGREE)) + geom_bar()
```
Most people in the group have high school degrees. 

```{r}
HAPPY$FINRELA= factor(HAPPY$FINRELA,levels= c("BELOW AVERAGE", "AVERAGE", "ABOVE AVERAGE"))
ggplot(data = HAPPY, aes(x= FINRELA)) + geom_bar()
```
Most people in the group have an average finrela level

```{r}
HAPPY$PARTYID= factor(HAPPY$PARTYID,levels= c("STRONG DEMOCRAT", "IND, NEAR DEM", "NOT STR DEMOCRAT", "INDEPENDENT", "NOT STR REPUBLICAN", "IND, NEAR REP", "STRONG REPULICAN", "OTHER PARTY"))
ggplot(data = HAPPY, aes(x= PARTYID)) + geom_bar()
```
Most people did not responde to the party id but the second morst was not strong democrat.

```{r}
HAPPY$POLVIEWS= factor(HAPPY$POLVIEWS,levels= c("EXTREMELY LIBERAL", "LIBERAL", "SLIGHTLY LIBERAL", "MODERATE", "SLIGHTLY CONSERVATIVE", "CONSERVATIVE", "EXTREMELY CONSERVATIVE"))
ggplot(data = HAPPY, aes(x= POLVIEWS)) + geom_bar()+ coord_flip()
```
besides the majority not ansering the question; second most of people said they were moderate. 


# Individual Exploration

## Alison Wyatt

Happiness vs Health
```{r}
ggplot(HAPPY, aes(x = HEALTH)) + geom_bar() + facet_wrap(HAPPY$HAPPY)
```
The "NOT TOO HAPPY" group had lower numbers of fair, good, and excellent health. "PRETTY HAPPY" had high levels in "IAP" and "GOOD" health and low levels in "POOR". "VERY HAPPY" also had low levels of "POOR" health. We could guess that being happier may reduce poor health. 

Happiness vs sex

```{r}
ggplot(HAPPY, aes(x = HAPPY)) + geom_bar() + facet_wrap(HAPPY$SEX)
```
More females are in the "PRETTY HAPPY" and "VERY HAPPY" categories, but there are also more females in the "NOT TOO HAPPY" category. "PRETTY HAPPY" is the most popular category for both males and females. Both graphs have a similar distribution with low numbers in the "NOT TOO HAPPY" and "NA" categories.

## Angelina Allen 

Happiness vs Maritial

```{r}
ggplot(HAPPY, aes(x = HAPPY)) + geom_bar() + facet_wrap(HAPPY$MARITAL) + coord_flip()
```
There do not seem like a huge defference between happiness levels across relationship status. It seems like the majority of people say they are pretty happy no matter what status they are in. Overall the distribution is low numbers in the not too happy portion and higher numbers in the pretty happy too very happy. 

Happiness vs Degree 

```{r}
ggplot(HAPPY, aes(x = HAPPY)) + geom_bar() + facet_wrap(HAPPY$DEGREE) + coord_flip()
```
There do not seem like a huge defference between happiness levels across degree level. It seems like the majority of people say they are pretty happy no matter what level they have. Overall the distribution is low numbers in the not too happy portion and higher numbers in the pretty happy too very happy. 
